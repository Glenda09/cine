<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8" />
  <title>Admin - Películas</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
</head>
<body>
<header class="p-3 bg-dark text-white">
  <div class="container d-flex gap-3 align-items-center">
    <a class="text-light" href="/admin">← Admin</a>
    <h1 class="h5 m-0">Películas</h1>
  </div>
</header>
<main class="container py-4">
  <form method="post" class="row g-2 mb-3">
    <div class="col-md-3"><input class="form-control" name="titulo" placeholder="Título" required></div>
    <div class="col-md-2"><input class="form-control" name="duracionMin" placeholder="Duración (min)" type="number"></div>
    <div class="col-md-3"><input class="form-control" name="posterUrl" placeholder="Poster URL"></div>
    <div class="col-md-2">
      <select class="form-select" name="clasif">
        <option value="TP">TP</option>
        <option value="_7PLUS">7+</option>
        <option value="_12PLUS">12+</option>
        <option value="_15PLUS">15+</option>
        <option value="_18PLUS">18+</option>
      </select>
    </div>
    <div class="col-md-2">
      <select class="form-select" name="tipo">
        <option value="DOSD">2D</option>
        <option value="TRESD">3D</option>
        <option value="IMAX">IMAX</option>
      </select>
    </div>
    <div class="col-12"><input class="form-control" name="sinopsis" placeholder="Sinopsis"></div>
    <div class="col-12"><button class="btn btn-primary" type="submit">Crear</button></div>
  </form>
  <!-- Edit form for pelicula -->
  <div th:if="${editPeli != null && editPeli.id != null}" class="mb-3">
    <form th:action="@{'/admin/peliculas/' + ${editPeli.id} + '/update'}" method="post" class="row g-2">
      <div class="col-md-3"><input class="form-control" name="titulo" th:value="${editPeli.titulo}" required></div>
      <div class="col-md-2"><input class="form-control" name="duracionMin" th:value="${editPeli.duracionMin}" type="number"></div>
      <div class="col-md-3"><input class="form-control" name="posterUrl" th:value="${editPeli.posterUrl}"></div>
      <div class="col-md-2">
        <select class="form-select" name="clasif">
          <option th:selected="${editPeli.clasificacionEdad.name()=='TP'}" value="TP">TP</option>
          <option th:selected="${editPeli.clasificacionEdad.name()=='_7PLUS'}" value="_7PLUS">7+</option>
          <option th:selected="${editPeli.clasificacionEdad.name()=='_12PLUS'}" value="_12PLUS">12+</option>
          <option th:selected="${editPeli.clasificacionEdad.name()=='_15PLUS'}" value="_15PLUS">15+</option>
          <option th:selected="${editPeli.clasificacionEdad.name()=='_18PLUS'}" value="_18PLUS">18+</option>
        </select>
      </div>
      <div class="col-md-2">
        <select class="form-select" name="tipo">
          <option th:selected="${editPeli.tipo.name()=='DOSD'}" value="DOSD">2D</option>
          <option th:selected="${editPeli.tipo.name()=='TRESD'}" value="TRESD">3D</option>
          <option th:selected="${editPeli.tipo.name()=='IMAX'}" value="IMAX">IMAX</option>
        </select>
      </div>
      <div class="col-12"><input class="form-control" name="sinopsis" th:value="${editPeli.sinopsis}"></div>
      <div class="col-12"><button class="btn btn-warning" type="submit">Actualizar</button></div>
    </form>
    <form th:action="@{'/admin/peliculas/' + ${editPeli.id} + '/delete'}" method="post" class="mt-2">
      <button class="btn btn-danger" type="submit" onclick="return confirm('¿Estás seguro de que quieres eliminar esta película?')">Eliminar</button>
    </form>
  </div>

  <div class="row row-cols-1 row-cols-md-3 g-3">
    <div class="col" th:each="p: ${list}">
      <div class="card h-100">
        <img class="card-img-top" th:if="${p.posterUrl}" th:src="${p.posterUrl}" />
        <div class="card-body">
          <h5 class="card-title" th:text="${p.titulo}"></h5>
          <p class="card-text" th:text="${p.sinopsis}"></p>
        </div>
      </div>
      <div class="mt-2"><a th:href="@{'/admin/peliculas/' + ${p.id} + '/edit'}" class="btn btn-sm btn-outline-secondary">Editar</a></div>
    </div>
  </div>
</main>
</body>
</html>

